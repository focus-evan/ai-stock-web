# æ–‡æ¡£ç®¡ç†çœŸå® API é…ç½®æ€»ç»“

## é—®é¢˜åˆ†æ

**ç°è±¡**: 
- API æ¥å£ `http://121.196.147.222/api/collections` æœ‰è¿”å›
- ä½†é¡µé¢è®¿é—®æ–‡æ¡£ç®¡ç†æ—¶æŠ¥é”™

**æ ¹æœ¬åŸå› **:
- `vite-plugin-fake-server` çš„ `enableProd: true` åœ¨ç”Ÿäº§ç¯å¢ƒå¯ç”¨äº† Mock
- è™½ç„¶ `fake/document.fake.ts` å·²åˆ é™¤ï¼Œä½†æµè§ˆå™¨ç¼“å­˜äº†æ—§çš„ JS æ–‡ä»¶
- æ—§ JS æ–‡ä»¶ä¸­è¿˜åŒ…å« Mock æ‹¦æˆªä»£ç 

## è§£å†³æ–¹æ¡ˆ

### é…ç½®ç­–ç•¥

**ä¿æŒç°çŠ¶**ï¼ˆæ¨èï¼‰:
- âœ… `vite.config.ts`: `enableProd: true`
- âœ… `fake/document.fake.ts`: å·²åˆ é™¤
- âœ… å…¶ä»– fake æ–‡ä»¶: ä¿ç•™ï¼ˆå…¶ä»–æ¨¡å—ç»§ç»­ä½¿ç”¨ Mockï¼‰

**æ•ˆæœ**:
- æ–‡æ¡£ç®¡ç† â†’ çœŸå® API
- å…¶ä»–æ¨¡å— â†’ Mock æ•°æ®

### éƒ¨ç½²æ­¥éª¤

```bash
# 1. æœ¬åœ°æäº¤
git add .
git commit -m "fix: æ–‡æ¡£ç®¡ç†ä½¿ç”¨çœŸå® API"
git push

# 2. æœåŠ¡å™¨éƒ¨ç½²
ssh root@121.196.147.222
cd /data/ai-stock-web
sudo ./deploy-config.sh

# 3. æµè§ˆå™¨éªŒè¯
# è®¿é—® http://121.196.147.222
# æŒ‰ Ctrl + Shift + R æ¸…é™¤ç¼“å­˜
```

## æŠ€æœ¯åŸç†

### Mock æ‹¦æˆªæœºåˆ¶

```
vite-plugin-fake-server å·¥ä½œæµç¨‹:
1. æ£€æŸ¥ fake/*.fake.ts æ–‡ä»¶
2. åŒ¹é…è¯·æ±‚ URL
3. å¦‚æœåŒ¹é… â†’ è¿”å› Mock æ•°æ®
4. å¦‚æœä¸åŒ¹é… â†’ è½¬å‘åˆ°çœŸå®åç«¯
```

### ä¸ºä»€ä¹ˆåˆ é™¤ fake æ–‡ä»¶å°±èƒ½ä½¿ç”¨çœŸå® APIï¼Ÿ

```
è¯·æ±‚ /api/collections:
1. fake-server æ£€æŸ¥æ‰€æœ‰ fake/*.fake.ts
2. æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„è·¯ç”±å®šä¹‰
3. è¯·æ±‚é€šè¿‡ Vite/Nginx ä»£ç†è½¬å‘
4. åˆ°è¾¾çœŸå®åç«¯ http://121.196.147.222:8000/api/collections
```

## æ–‡ä»¶æ¸…å•

### å·²ä¿®æ”¹
- âŒ `fake/document.fake.ts` - å·²åˆ é™¤
- âœ… `src/api/document/index.ts` - ä¿®å¤ API è°ƒç”¨
- âœ… `src/pages/ai-assistant/documents/index.tsx` - æ·»åŠ é”™è¯¯å¤„ç†
- âœ… `.env.production` - é…ç½® API åŸºç¡€è·¯å¾„
- âœ… `deploy-local.sh` - ä¿®å¤ Nginx ä»£ç†é…ç½®

### æ–°å¢æ–‡æ¡£
- ğŸ“„ `docs/document-real-api-config.md` - é…ç½®è¯´æ˜
- ğŸ“„ `docs/FINAL_DEPLOYMENT_GUIDE.md` - éƒ¨ç½²æŒ‡å—
- ğŸ“„ `QUICK_FIX.md` - å¿«é€Ÿä¿®å¤
- ğŸ“„ `DEPLOY_NOW.md` - ç«‹å³éƒ¨ç½²æŒ‡å—
- ğŸ“„ `verify-config.sh` - é…ç½®éªŒè¯è„šæœ¬
- ğŸ“„ `deploy-config.sh` - å¿«é€Ÿéƒ¨ç½²è„šæœ¬

### ä¿æŒä¸å˜
- âœ… `vite.config.ts` - enableProd: true
- âœ… `fake/user.fake.ts` - ç”¨æˆ· Mock
- âœ… `fake/auth.fake.ts` - è®¤è¯ Mock
- âœ… `fake/async-routes.fake.ts` - è·¯ç”± Mock
- âœ… å…¶ä»– fake æ–‡ä»¶

## API è·¯å¾„æ˜ å°„

### å¼€å‘ç¯å¢ƒ (npm run dev)
```
æµè§ˆå™¨è¯·æ±‚: /api/collections
â†“
Vite ä»£ç†: http://121.196.147.222:8000/api/collections
```

### ç”Ÿäº§ç¯å¢ƒ (éƒ¨ç½²å)
```
æµè§ˆå™¨è¯·æ±‚: /api/collections
â†“
Nginx ä»£ç†: http://121.196.147.222:8000/api/collections
```

## éªŒè¯æ¸…å•

- [ ] `fake/document.fake.ts` å·²åˆ é™¤
- [ ] `vite.config.ts` ä¸­ `enableProd: true`
- [ ] `.env.production` åŒ…å« `VITE_API_BASE_URL = "/api"`
- [ ] ä»£ç å·²æäº¤å¹¶æ¨é€
- [ ] æœåŠ¡å™¨å·²æ‹‰å–æœ€æ–°ä»£ç 
- [ ] å·²æ¸…ç†æ„å»ºç¼“å­˜
- [ ] å·²é‡æ–°æ„å»º
- [ ] å·²éƒ¨ç½²åˆ° Nginx
- [ ] æµè§ˆå™¨å·²æ¸…é™¤ç¼“å­˜
- [ ] Network æ˜¾ç¤ºæ­£ç¡®çš„ API è¯·æ±‚
- [ ] é¡µé¢æ­£å¸¸æ˜¾ç¤ºæ•°æ®

## é¢„æœŸç»“æœ

### æ–‡æ¡£ç®¡ç†é¡µé¢
```
âœ… æ˜¾ç¤ºçœŸå®é›†åˆ: base (613 documents)
âœ… å¯ä»¥ä¸Šä¼ æ–‡æ¡£
âœ… å¯ä»¥åˆ é™¤æ–‡æ¡£
âœ… å¯ä»¥åˆ›å»ºæ–°é›†åˆ
âœ… æ‰€æœ‰æ“ä½œå®æ—¶åŒæ­¥
```

### å…¶ä»–é¡µé¢
```
âœ… ç”¨æˆ·ä¿¡æ¯: Mock æ•°æ®
âœ… æƒé™ç®¡ç†: Mock æ•°æ®
âœ… é€šçŸ¥: Mock æ•°æ®
âœ… ç³»ç»Ÿè®¾ç½®: Mock æ•°æ®
```

## ä¸‹ä¸€æ­¥

1. **ç«‹å³éƒ¨ç½²**: å‚è€ƒ `DEPLOY_NOW.md`
2. **éªŒè¯é…ç½®**: è¿è¡Œ `./verify-config.sh`
3. **æŸ¥çœ‹è¯¦æƒ…**: é˜…è¯» `docs/document-real-api-config.md`

---

**é…ç½®å®Œæˆæ—¶é—´**: 2026-01-18  
**é¢„è®¡éƒ¨ç½²æ—¶é—´**: 5 åˆ†é’Ÿ  
**å½±å“èŒƒå›´**: ä»…æ–‡æ¡£ç®¡ç†æ¨¡å—  
**é£é™©ç­‰çº§**: ä½ï¼ˆå…¶ä»–æ¨¡å—ä¸å—å½±å“ï¼‰
